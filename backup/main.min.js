document.addEventListener("DOMContentLoaded", function () {
  var e = [].slice.call(document.querySelectorAll("img.lazy")),
    n = [].slice.call(document.querySelectorAll(".lazy-background")),
    t = [].slice.call(document.querySelectorAll("[data-bg]"));
  if ("IntersectionObserver" in window) {
    let o = new IntersectionObserver(function (e, n) {
      e.forEach(function (e) {
        if (e.isIntersecting) {
          let n = e.target;
          (n.src = n.dataset.src),
            (n.srcset = n.dataset.srcset),
            n.classList.remove("lazy"),
            o.unobserve(n);
        }
      });
    });
    e.forEach(function (e) {
      o.observe(e);
    });
    let c = new IntersectionObserver(function (e, n) {
      e.forEach(function (e) {
        e.isIntersecting &&
          (e.target.classList.add("visible"), c.unobserve(e.target));
      });
    });
    n.forEach(function (e) {
      c.observe(e);
    });
    let i = new IntersectionObserver(function (e, n) {
      e.forEach(function (e) {
        if (e.isIntersecting) {
          let n = e.target;
          (n.style.backgroundImage = "url(" + n.dataset.bg + ")"),
            i.unobserve(n);
        }
      });
    });
    t.forEach(function (e) {
      i.observe(e);
    });
  } else
    e.forEach(function (e) {
      (e.src = e.dataset.src), (e.srcset = e.dataset.srcset);
    }),
      n.forEach(function (e) {
        e.classList.add("visible");
      }),
      t.forEach(function (e) {
        e.style.backgroundImage = "url(" + e.dataset.bg + ")";
      });
}),
  $(function () {
    $(".first_word").html(function (e, n) {
      return n.replace(/^(\w+|[[а-яА-ЯёЁ]+)/, "<span>$1</span>");
    }),
      $(".event__time").html(function (e, n) {
        return n.replace(/^(\w+|[[а-яА-ЯёЁ]+)/, "<span>$1</span>");
      }),
      $(".accordion__text").not().hide(),
      $(".accordion__open").click(function () {
        var e = $(this).next(),
          n = $(this).closest(".accordion__wrapper");
        e.is(":visible")
          ? (e.slideUp("fast"),
            $(".accordion__open i")
              .removeClass("icon-up-dir")
              .addClass("icon-down-dir"))
          : (n.find(".accordion__text").slideUp("fast"),
            e.slideDown("fast"),
            $(".accordion__open i")
              .removeClass("icon-up-dir")
              .addClass("icon-down-dir"),
            $(this)
              .find("i")
              .removeClass("icon-down-dir")
              .addClass("icon-up-dir"));
      }),
      $(".popapOpen-main").click(function () {
        o(".hidden_block-main");
      }),
      $(".popapClose").click(function () {
        $("body").removeClass("popapOpen"),
          $(".hidden_block").removeClass("active"),
          $(".main-body").removeClass("active"),
          $(this).parents(".main-body").find("form").trigger("reset");
      }),
      $(".popapOpen").click(function () {
        o(".hidden_block-callback");
      }),
      $(".popapOpen-product").click(function () {
        o(".hidden_block-product");
      });
    let e = $(".pice_out span").text(),
      n = +$(".sand_price-1").text(),
      t = +$(".sand_price-2").text();
    function o(e) {
      $("body").addClass("popapOpen"),
        $(e).addClass("active"),
        $(".main-body").addClass("active");
    }
    $(".popapOpen-product-1").click(function () {
      o(".hidden_block-product-1"), (e = $(".pice_out span").text(n));
    }),
      $(".popapOpen-product-2").click(function () {
        o(".hidden_block-product-2"), (e = $(".pice_out span").text(t));
      }),
      $(".popapClose-product-1").click(function () {
        e = $(".pice_out span").text(n);
      }),
      $(".popapClose-product-2").click(function () {
        e = $(".pice_out span").text(t);
      }),
      $(".map_scroll_btn").on("click", "a", function (e) {
        e.preventDefault();
        var n = $(this).attr("href"),
          t = $(n).offset().top;
        $("body,html").animate({ scrollTop: t }, 1500);
      }),
      $("ul.sand_tabs__header").on("click", "li:not(.active)", function () {
        $(this)
          .addClass("active")
          .siblings()
          .removeClass("active")
          .closest("div.sand_tabs")
          .find("div.sand_tabs__content")
          .removeClass("active")
          .eq($(this).index())
          .addClass("active");
      }),
      $(".click_phone").click(function () {
        return ym(54371932, "reachGoal", "click_phone "), !0;
      }),
      $(".copy_phone").bind("copy", function () {
        return ym(54371932, "reachGoal", "copy_phone"), !0;
      }),
      $(".copy_mail").bind("copy", function () {
        return ym(54371932, "reachGoal", "copy_email"), !0;
      }),
      $(".hidden_block ").mouseup(function (e) {
        var n = $("form");
        n.is(e.target) ||
          0 !== n.has(e.target).length ||
          ($("body").removeClass("popapOpen"),
          $(".hidden_block").removeClass("active"),
          $(".main-body").removeClass("active"),
          $(this).parents(".main-body").find("form").trigger("reset"));
      });
  }),
  $(document).keydown(function (e) {
    27 == e.which &&
      ($("body").removeClass("popapOpen"),
      $(".hidden_block").removeClass("active"),
      $(".main-body").removeClass("active"),
      $(this).parents(".main-body").find("form").trigger("reset"));
  });
